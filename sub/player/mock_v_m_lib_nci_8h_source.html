<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>AiCPlayer: testPlayer/mockVMLibNci.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">AiCPlayer
   
   </div>
   <div id="projectbrief">Interface of aic vm - for rendering aspect, sensors, video records</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Quick&#160;intro</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">testPlayer/mockVMLibNci.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mock_v_m_lib_nci_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;signal.h&gt;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;stdint.h&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &quot;<a class="code" href="sensors_8h.html" title="Defines ports and structures for sensor threads.">sensors.h</a>&quot;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &quot;<a class="code" href="player__nfc_8h.html" title="Nfc player.">player_nfc.h</a>&quot;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &quot;nfc.pb-c.h&quot;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;<a class="code" href="buffer__sizes_8h.html" title="Define common buffer sizes.">buffer_sizes.h</a>&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;<a class="code" href="socket_8h.html" title="Define socket utilities to simplify networking.">socket.h</a>&quot;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="amqp__listen_8h.html" title="Utilities for consuming RabbitMQ messages.">amqp_listen.h</a>&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="config__env_8h.html" title="Utilities to get config values from the environment.">config_env.h</a>&quot;</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="logger_8h.html" title="Logging macros.">logger.h</a>&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;pthread.h&gt;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="comment">//_____________________</span>
<a name="l00019"></a>00019 
<a name="l00020"></a><a class="code" href="mock_v_m_lib_nci_8h.html#af673935c062f6ca9b5dedcf5f2e7ebff">00020</a> <span class="preprocessor">#define NCI_BRCM_CO_ID 0x2E</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a>00022 <span class="comment">/* Define the message header size for all NCI Commands and Notifications.</span>
<a name="l00023"></a>00023 <span class="comment">*/</span>
<a name="l00024"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a77191d5b64da4bed1e6476a05b0f15e4">00024</a> <span class="preprocessor">#define NCI_MSG_HDR_SIZE 3  </span><span class="comment">/* per NCI spec */</span>
<a name="l00025"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a78b3dda44a9f3255a735b5c4802b93c6">00025</a> <span class="preprocessor">#define NCI_DATA_HDR_SIZE 3 </span><span class="comment">/* per NCI spec */</span>
<a name="l00026"></a><a class="code" href="mock_v_m_lib_nci_8h.html#aea3d8cebf228330819d7b9dee848b223">00026</a> <span class="preprocessor">#define NCI_MAX_PAYLOAD_SIZE 0xFE</span>
<a name="l00027"></a><a class="code" href="mock_v_m_lib_nci_8h.html#afd7725568a8ebfb3c5d6bd4baf910c05">00027</a> <span class="preprocessor"></span><span class="preprocessor">#define NCI_MAX_CTRL_SIZE 0xFF </span><span class="comment">/* max control message size */</span>
<a name="l00028"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a5364df4ddbd7d9e8c3d0b51af531fd03">00028</a> <span class="preprocessor">#define NCI_CTRL_INIT_SIZE 32  </span><span class="comment">/* initial NFCC control payload size */</span>
<a name="l00029"></a><a class="code" href="mock_v_m_lib_nci_8h.html#ad3d29ebcb4979d53755574731eaf3fa2">00029</a> <span class="preprocessor">#define NCI_MAX_VSC_SIZE 0xFF</span>
<a name="l00030"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a2735a3e2d47082203dca7ae2896fcd7f">00030</a> <span class="preprocessor"></span><span class="preprocessor">#define NCI_VSC_MSG_HDR_SIZE                                                                       \</span>
<a name="l00031"></a>00031 <span class="preprocessor">    12 </span><span class="comment">/* NCI header (3) + callback function pointer(8; use 8 to be safe) + HCIT (1 byte) */</span>
<a name="l00032"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a4f35e3932aad744f20b035cab651aee4">00032</a> <span class="preprocessor">#define NCI_TL_SIZE 2</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a4920dc65d4311fa1319e2500d37dd848">00034</a> <span class="preprocessor">#define NCI_ISO_DEP_MAX_INFO                                                                       \</span>
<a name="l00035"></a>00035 <span class="preprocessor">    253 </span><span class="comment">/* Max frame size (256) - Prologue (1) - Epilogue (2) in ISO-DEP, CID and NAD are not      \</span>
<a name="l00036"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a4aa485ce5a7c3ca3856afcd1af977f30">00036</a> <span class="comment">           used*/</span>
<a name="l00037"></a>00037 <span class="preprocessor">#define NCI_NFC_DEP_MAX_DATA                                                                       \</span>
<a name="l00038"></a>00038 <span class="preprocessor">    251 </span><span class="comment">/* Max payload (254) - Protocol Header (3) in NFC-DEP, DID and NAD are not used */</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="comment">/* NCI Command and Notification Format:</span>
<a name="l00041"></a>00041 <span class="comment"> * 3 byte message header:</span>
<a name="l00042"></a>00042 <span class="comment"> * byte 0: MT PBF GID</span>
<a name="l00043"></a>00043 <span class="comment"> * byte 1: OID</span>
<a name="l00044"></a>00044 <span class="comment"> * byte 2: Message Length */</span>
<a name="l00045"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a505da5602ac31a60d4f364700cec3f8f">00045</a> <span class="comment">/* MT: Message Type (byte 0) */</span>
<a name="l00046"></a><a class="code" href="mock_v_m_lib_nci_8h.html#af82851133eac2834721d69f41a02d216">00046</a> <span class="preprocessor">#define NCI_MT_MASK 0xE0</span>
<a name="l00047"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a36f2c12f2be7ab513d7c759299d64f3c">00047</a> <span class="preprocessor"></span><span class="preprocessor">#define NCI_MT_SHIFT 5</span>
<a name="l00048"></a><a class="code" href="mock_v_m_lib_nci_8h.html#afad5b472c1b51b55bb2948594b5de694">00048</a> <span class="preprocessor"></span><span class="preprocessor">#define NCI_MT_DATA 0x00</span>
<a name="l00049"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a4af01b80294a05fb525cc5f4f21a18a4">00049</a> <span class="preprocessor"></span><span class="preprocessor">#define NCI_MT_CMD 1 </span><span class="comment">/* (NCI_MT_CMD &lt;&lt; NCI_MT_SHIFT) = 0x20 */</span>
<a name="l00050"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a405e9575d390e45e2b9dfc9a17a0511e">00050</a> <span class="preprocessor">#define NCI_MT_RSP 2 </span><span class="comment">/* (NCI_MT_RSP &lt;&lt; NCI_MT_SHIFT) = 0x40 */</span>
<a name="l00051"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a1caa87ce3c6708dd6302554c70aa2025">00051</a> <span class="preprocessor">#define NCI_MT_NTF 3 </span><span class="comment">/* (NCI_MT_NTF &lt;&lt; NCI_MT_SHIFT) = 0x60 */</span>
<a name="l00052"></a>00052 <span class="preprocessor">#define NCI_MT_CFG 4 </span><span class="comment">/* (NCI_MT_CFG &lt;&lt; NCI_MT_SHIFT) = 0x80 */</span>
<a name="l00053"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a11ed563e9ddb7f7ebfd0c1579f8bf060">00053</a> 
<a name="l00054"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a0134025269c1421da6e2ad9b91d42b37">00054</a> <span class="preprocessor">#define NCI_MTS_CMD 0x20</span>
<a name="l00055"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a6445b8b27f787046c6fdd21141c29496">00055</a> <span class="preprocessor"></span><span class="preprocessor">#define NCI_MTS_RSP 0x40</span>
<a name="l00056"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a42c0a0e8b56d5778e03aeaf5c3c48544">00056</a> <span class="preprocessor"></span><span class="preprocessor">#define NCI_MTS_NTF 0x60</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span><span class="preprocessor">#define NCI_MTS_CFG 0x80</span>
<a name="l00058"></a><a class="code" href="mock_v_m_lib_nci_8h.html#aff22bce2c0944fcfdafb3b925048196c">00058</a> <span class="preprocessor"></span>
<a name="l00059"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a3b7b2b592f8ec5add32cdf980a80eb3d">00059</a> <span class="preprocessor">#define NCI_NTF_BIT 0x80 </span><span class="comment">/* the tNFC_VS_EVT is a notification */</span>
<a name="l00060"></a>00060 <span class="preprocessor">#define NCI_RSP_BIT 0x40 </span><span class="comment">/* the tNFC_VS_EVT is a response     */</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">/* for internal use only; not from specification */</span>
<a name="l00063"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a7f99338f2ce128a0fc8ff0c0c5608b92">00063</a> <span class="comment">/* the following 2 flags are used in layer_specific for fragmentation/reassembly of data packets */</span>
<a name="l00064"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a3dd1d2fd39dfba057424ddb35df3828e">00064</a> <span class="preprocessor">#define NCI_LS_DATA 0x00</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span><span class="preprocessor">#define NCI_LS_DATA_PBF 0x01</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00067"></a><a class="code" href="mock_v_m_lib_nci_8h.html#ae704d063b29d516edbe5924ccbbf049c">00067</a> <span class="comment">/* PBF: Packet Boundary Flag (byte 0) */</span>
<a name="l00068"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a3d6eced43c16ef2410cf4001e4087819">00068</a> <span class="preprocessor">#define NCI_PBF_MASK 0x10</span>
<a name="l00069"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a20319f0126fee841d139bb8e7ba70d39">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define NCI_PBF_SHIFT 4</span>
<a name="l00070"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a1cb2558c69e17407b33633a7c19bf7f3">00070</a> <span class="preprocessor"></span><span class="preprocessor">#define NCI_PBF_NO_OR_LAST 0x00 </span><span class="comment">/* not fragmented or last fragment */</span>
<a name="l00071"></a>00071 <span class="preprocessor">#define NCI_PBF_ST_CONT 0x10    </span><span class="comment">/* start or continuing fragment */</span>
<a name="l00072"></a>00072 
<a name="l00073"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a074892c9d04018a039239dea8c465bdb">00073</a> <span class="comment">/* GID: Group Identifier (byte 0) */</span>
<a name="l00074"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a9b520c4cbbd39505f9e7278d25b13654">00074</a> <span class="preprocessor">#define NCI_GID_MASK 0x0F</span>
<a name="l00075"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a9834a37a58e90718b3aa4d8d99c66135">00075</a> <span class="preprocessor"></span><span class="preprocessor">#define NCI_GID_SHIFT 0</span>
<a name="l00076"></a><a class="code" href="mock_v_m_lib_nci_8h.html#ab523d6d7f029a44f2da4e392c4f697b8">00076</a> <span class="preprocessor"></span><span class="preprocessor">#define NCI_GID_CORE 0x00      </span><span class="comment">/* 0000b NCI Core group */</span>
<a name="l00077"></a><a class="code" href="mock_v_m_lib_nci_8h.html#ab105e6ec7e1a062c922fb6bde9140106">00077</a> <span class="preprocessor">#define NCI_GID_RF_MANAGE 0x01 </span><span class="comment">/* 0001b RF Management group */</span>
<a name="l00078"></a><a class="code" href="mock_v_m_lib_nci_8h.html#af65bc29ad19b53a9dc12091065489e63">00078</a> <span class="preprocessor">#define NCI_GID_EE_MANAGE 0x02 </span><span class="comment">/* 0010b NFCEE Management group */</span>
<a name="l00079"></a>00079 <span class="preprocessor">#define NCI_GID_PROP 0x0F      </span><span class="comment">/* 1111b Proprietary */</span>
<a name="l00080"></a>00080 <span class="comment">/* 0111b - 1110b RFU */</span>
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="mock_v_m_lib_nci_8h.html#aff0f571191e3ff5e791a838771b2b993">00082</a> <span class="comment">/* OID: Opcode Identifier (byte 1) */</span>
<a name="l00083"></a><a class="code" href="mock_v_m_lib_nci_8h.html#acf83228de9f0b83fa99a9ff75603673b">00083</a> <span class="preprocessor">#define NCI_OID_MASK 0x3F</span>
<a name="l00084"></a>00084 <span class="preprocessor"></span><span class="preprocessor">#define NCI_OID_SHIFT 0</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span>
<a name="l00086"></a><a class="code" href="mock_v_m_lib_nci_8h.html#aa82393b4c2ed1114363cb9110bca676e">00086</a> <span class="comment">/* For routing */</span>
<a name="l00087"></a>00087 <span class="preprocessor">#define NCI_DH_ID 0 </span><span class="comment">/* for DH */</span>
<a name="l00088"></a><a class="code" href="mock_v_m_lib_nci_8h.html#aab6ed5997d64ffd0d38a6d8fb521f35b">00088</a> <span class="comment">/* To identify the loopback test */</span>
<a name="l00089"></a>00089 <span class="preprocessor">#define NCI_TEST_ID 0xFE </span><span class="comment">/* for loopback test */</span>
<a name="l00090"></a>00090 
<a name="l00091"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a180eb9aaf038911f54b1a1dabf5d66b0">00091</a> <span class="comment">/* Destination Type */</span>
<a name="l00092"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a0e142c438a11e989afbaad2e8e620a0c">00092</a> <span class="preprocessor">#define NCI_DEST_TYPE_NFCC 1   </span><span class="comment">/* NFCC - loopback */</span>
<a name="l00093"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a02f86a35cce623b0ed6472543750d1b3">00093</a> <span class="preprocessor">#define NCI_DEST_TYPE_REMOTE 2 </span><span class="comment">/* Remote NFC Endpoint */</span>
<a name="l00094"></a>00094 <span class="preprocessor">#define NCI_DEST_TYPE_NFCEE 3  </span><span class="comment">/* NFCEE */</span>
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a65cc683f0fba4519910b0e87f11b2fe0">00096</a> <span class="comment">/* builds byte0 of NCI Command and Notification packet */</span>
<a name="l00097"></a>00097 <span class="preprocessor">#define NCI_MSG_BLD_HDR0(p, mt, gid) *(p)++ = (uint8_t)(((mt) &lt;&lt; NCI_MT_SHIFT) | (gid));</span>
<a name="l00098"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a8c6122b859d6bdedd73e15c9b6420285">00098</a> <span class="preprocessor"></span>
<a name="l00099"></a>00099 <span class="preprocessor">#define NCI_MSG_PBLD_HDR0(p, mt, pbf, gid)                                                         \</span>
<a name="l00100"></a>00100 <span class="preprocessor">    *(p)++ = (uint8_t)(((mt) &lt;&lt; NCI_MT_SHIFT) | ((pbf) &lt;&lt; NCI_PBF_SHIFT) | (gid));</span>
<a name="l00101"></a>00101 <span class="preprocessor"></span>
<a name="l00102"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a12ee8f3b5dbe25ffb7be6b495d39cf69">00102</a> <span class="comment">/* builds byte1 of NCI Command and Notification packet */</span>
<a name="l00103"></a>00103 <span class="preprocessor">#define NCI_MSG_BLD_HDR1(p, oid) *(p)++ = (uint8_t)(((oid) &lt;&lt; NCI_OID_SHIFT));</span>
<a name="l00104"></a>00104 <span class="preprocessor"></span>
<a name="l00105"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a4e04f86f18014204bad25f00b1d22bec">00105</a> <span class="comment">/* parse byte0 of NCI packet */</span>
<a name="l00106"></a>00106 <span class="preprocessor">#define NCI_MSG_PRS_HDR0(p, mt, pbf, gid)                                                          \</span>
<a name="l00107"></a>00107 <span class="preprocessor">    mt = (*(p) &amp;NCI_MT_MASK) &gt;&gt; NCI_MT_SHIFT;                                                      \</span>
<a name="l00108"></a>00108 <span class="preprocessor">    pbf = (*(p) &amp;NCI_PBF_MASK) &gt;&gt; NCI_PBF_SHIFT;                                                   \</span>
<a name="l00109"></a>00109 <span class="preprocessor">    gid = *(p)++ &amp; NCI_GID_MASK;</span>
<a name="l00110"></a>00110 <span class="preprocessor"></span>
<a name="l00111"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a31719faaff87c3802a5b15b27c82a385">00111</a> <span class="comment">/* parse MT and PBF bits of NCI packet */</span>
<a name="l00112"></a>00112 <span class="preprocessor">#define NCI_MSG_PRS_MT_PBF(p, mt, pbf)                                                             \</span>
<a name="l00113"></a>00113 <span class="preprocessor">    mt = (*(p) &amp;NCI_MT_MASK) &gt;&gt; NCI_MT_SHIFT;                                                      \</span>
<a name="l00114"></a>00114 <span class="preprocessor">    pbf = (*(p) &amp;NCI_PBF_MASK) &gt;&gt; NCI_PBF_SHIFT;</span>
<a name="l00115"></a>00115 <span class="preprocessor"></span>
<a name="l00116"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a27f0b0c889b89cab20f9e7802a76e206">00116</a> <span class="comment">/* parse byte1 of NCI Cmd/Ntf */</span>
<a name="l00117"></a>00117 <span class="preprocessor">#define NCI_MSG_PRS_HDR1(p, oid)                                                                   \</span>
<a name="l00118"></a>00118 <span class="preprocessor">    oid = (*(p) &amp;NCI_OID_MASK);                                                                    \</span>
<a name="l00119"></a>00119 <span class="preprocessor">    (p)++;</span>
<a name="l00120"></a>00120 <span class="preprocessor"></span>
<a name="l00121"></a>00121 <span class="comment">/* NCI Data Format:</span>
<a name="l00122"></a>00122 <span class="comment"> * byte 0: MT(0) PBF CID</span>
<a name="l00123"></a>00123 <span class="comment"> * byte 1: RFU</span>
<a name="l00124"></a>00124 <span class="comment"> * byte 2: Data Length */</span>
<a name="l00125"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a2c366a02c0cec9195b41a50ad2183719">00125</a> <span class="comment">/* CID: Connection Identifier (byte 0) 1-0xF Dynamically assigned (by NFCC), 0 is predefined  */</span>
<a name="l00126"></a>00126 <span class="preprocessor">#define NCI_CID_MASK 0x0F</span>
<a name="l00127"></a>00127 <span class="preprocessor"></span>
<a name="l00128"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a27470f05a997a9b4db03e3d36bbb6dfe">00128</a> <span class="comment">/* builds 3-byte message header of NCI Data packet */</span>
<a name="l00129"></a>00129 <span class="preprocessor">#define NCI_DATA_BLD_HDR(p, cid, len)                                                              \</span>
<a name="l00130"></a>00130 <span class="preprocessor">    *(p)++ = (uint8_t)(cid);                                                                       \</span>
<a name="l00131"></a>00131 <span class="preprocessor">    *(p)++ = 0;                                                                                    \</span>
<a name="l00132"></a>00132 <span class="preprocessor">    *(p)++ = (uint8_t)(len);</span>
<a name="l00133"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a3ae6f850bf6c16473e268283811597e2">00133</a> <span class="preprocessor"></span>
<a name="l00134"></a>00134 <span class="preprocessor">#define NCI_DATA_PBLD_HDR(p, pbf, cid, len)                                                        \</span>
<a name="l00135"></a>00135 <span class="preprocessor">    *(p)++ = (uint8_t)(((pbf) &lt;&lt; NCI_PBF_SHIFT) | (cid));                                          \</span>
<a name="l00136"></a>00136 <span class="preprocessor">    *(p)++ = 0;                                                                                    \</span>
<a name="l00137"></a>00137 <span class="preprocessor">    *(p)++ = (len);</span>
<a name="l00138"></a><a class="code" href="mock_v_m_lib_nci_8h.html#ac39d063a7fb18b4135cbb6aee39fdb17">00138</a> <span class="preprocessor"></span>
<a name="l00139"></a>00139 <span class="preprocessor">#define NCI_DATA_PRS_HDR(p, pbf, cid, len)                                                         \</span>
<a name="l00140"></a>00140 <span class="preprocessor">    (pbf) = (*(p) &amp;NCI_PBF_MASK) &gt;&gt; NCI_PBF_SHIFT;                                                 \</span>
<a name="l00141"></a>00141 <span class="preprocessor">    (cid) = (*(p) &amp;NCI_CID_MASK);                                                                  \</span>
<a name="l00142"></a>00142 <span class="preprocessor">    p++;                                                                                           \</span>
<a name="l00143"></a>00143 <span class="preprocessor">    p++;                                                                                           \</span>
<a name="l00144"></a>00144 <span class="preprocessor">    (len) = *(p)++;</span>
<a name="l00145"></a>00145 <span class="preprocessor"></span>
<a name="l00146"></a>00146 <span class="comment">/* Logical target ID 0x01-0xFE */</span>
<a name="l00147"></a><a class="code" href="mock_v_m_lib_nci_8h.html#ac6344beffddee011becec0c8a4c43be5">00147</a> 
<a name="l00148"></a>00148 <span class="preprocessor">#define BE_STREAM_TO_uint32_t(u32, p)                                                              \</span>
<a name="l00149"></a>00149 <span class="preprocessor">    {                                                                                              \</span>
<a name="l00150"></a>00150 <span class="preprocessor">        u32 = ((uint32_t)(*((p) + 3)) + ((uint32_t)(*((p) + 2)) &lt;&lt; 8) +                            \</span>
<a name="l00151"></a>00151 <span class="preprocessor">               ((uint32_t)(*((p) + 1)) &lt;&lt; 16) + ((uint32_t)(*(p)) &lt;&lt; 24));                         \</span>
<a name="l00152"></a>00152 <span class="preprocessor">        (p) += 4;                                                                                  \</span>
<a name="l00153"></a>00153 <span class="preprocessor">    }</span>
<a name="l00154"></a>00154 <span class="preprocessor"></span>
<a name="l00155"></a>00155 <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00156"></a>00156 {
<a name="l00157"></a>00157     uint16_t event;
<a name="l00158"></a>00158     uint16_t len;
<a name="l00159"></a>00159     uint16_t offset;
<a name="l00160"></a>00160     uint16_t layer_specific;
<a name="l00161"></a>00161 } <a class="code" href="struct_b_t___h_d_r.html">BT_HDR</a>;
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="comment">/* Define the status code returned from the Validate, Parse or Build functions</span>
<a name="l00164"></a>00164 <span class="comment">*/</span>
<a name="l00165"></a>00165 <span class="keyword">enum</span>
<a name="l00166"></a><a class="code" href="mock_v_m_lib_nci_8h.html#adf764cbdea00d65edcd07bb9953ad2b7ac21c377d3c00e39fdbdcb7e9d2889cd0">00166</a> {
<a name="l00167"></a>00167     <a class="code" href="test_validate_n_f_c_8c.html#a06fc87d81c62e9abb8790b6e5713c55bac21c377d3c00e39fdbdcb7e9d2889cd0">NDEF_OK</a>, <span class="comment">/* 0 - OK                                   */</span>
<a name="l00168"></a><a class="code" href="mock_v_m_lib_nci_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a79ea5247c5246396865b7bf3e3ae6697">00168</a> 
<a name="l00169"></a><a class="code" href="mock_v_m_lib_nci_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a0625866e9bd815dace8fc99cda55af82">00169</a>     <a class="code" href="test_validate_n_f_c_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba79ea5247c5246396865b7bf3e3ae6697">NDEF_REC_NOT_FOUND</a>,         <span class="comment">/* 1 - No record matching the find criteria */</span>
<a name="l00170"></a><a class="code" href="mock_v_m_lib_nci_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a4a05e8c547dc1644a28fef9628f43e6c">00170</a>     <a class="code" href="test_validate_n_f_c_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba0625866e9bd815dace8fc99cda55af82">NDEF_MSG_TOO_SHORT</a>,         <span class="comment">/* 2 - Message was too short (&lt; 3 bytes)    */</span>
<a name="l00171"></a><a class="code" href="mock_v_m_lib_nci_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a72c27b689233c29183f0dc9d01156352">00171</a>     <a class="code" href="test_validate_n_f_c_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba4a05e8c547dc1644a28fef9628f43e6c">NDEF_MSG_NO_MSG_BEGIN</a>,      <span class="comment">/* 3 - No &#39;begin&#39; flag at start of message  */</span>
<a name="l00172"></a><a class="code" href="mock_v_m_lib_nci_8h.html#adf764cbdea00d65edcd07bb9953ad2b7aca0148c997db995f6b05b287ffa0f15d">00172</a>     <a class="code" href="test_validate_n_f_c_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba72c27b689233c29183f0dc9d01156352">NDEF_MSG_NO_MSG_END</a>,        <span class="comment">/* 4 - No &#39;end&#39; flag at end of message      */</span>
<a name="l00173"></a><a class="code" href="mock_v_m_lib_nci_8h.html#adf764cbdea00d65edcd07bb9953ad2b7aa92952c05891788f030d467efc24f56d">00173</a>     <a class="code" href="test_validate_n_f_c_8c.html#a06fc87d81c62e9abb8790b6e5713c55baca0148c997db995f6b05b287ffa0f15d">NDEF_MSG_EXTRA_MSG_BEGIN</a>,   <span class="comment">/* 5 - &#39;begin&#39; flag after start of message  */</span>
<a name="l00174"></a><a class="code" href="mock_v_m_lib_nci_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a4a38e882658b7c5c2b936c9ec4562841">00174</a>     <a class="code" href="test_validate_n_f_c_8c.html#a06fc87d81c62e9abb8790b6e5713c55baa92952c05891788f030d467efc24f56d">NDEF_MSG_UNEXPECTED_CHUNK</a>,  <span class="comment">/* 6 - Unexpected chunk found               */</span>
<a name="l00175"></a><a class="code" href="mock_v_m_lib_nci_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a1f2b306b01904a17ff74fd6f09e61a41">00175</a>     <a class="code" href="test_validate_n_f_c_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba4a38e882658b7c5c2b936c9ec4562841">NDEF_MSG_INVALID_EMPTY_REC</a>, <span class="comment">/* 7 - Empty record with non-zero contents  */</span>
<a name="l00176"></a><a class="code" href="mock_v_m_lib_nci_8h.html#adf764cbdea00d65edcd07bb9953ad2b7afe97aaf6dd9462ac5f339b9ebf1704ad">00176</a>     <a class="code" href="test_validate_n_f_c_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba1f2b306b01904a17ff74fd6f09e61a41">NDEF_MSG_INVALID_CHUNK</a>,     <span class="comment">/* 8 - Invalid chunk found                  */</span>
<a name="l00177"></a><a class="code" href="mock_v_m_lib_nci_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a06b4d8dc988b137d42b07ddd9c0c9393">00177</a>     <a class="code" href="test_validate_n_f_c_8c.html#a06fc87d81c62e9abb8790b6e5713c55bafe97aaf6dd9462ac5f339b9ebf1704ad">NDEF_MSG_LENGTH_MISMATCH</a>,   <span class="comment">/* 9 - Overall message length doesn&#39;t match */</span>
<a name="l00178"></a>00178     <a class="code" href="test_validate_n_f_c_8c.html#a06fc87d81c62e9abb8790b6e5713c55ba06b4d8dc988b137d42b07ddd9c0c9393">NDEF_MSG_INSUFFICIENT_MEM</a>   <span class="comment">/* 10 - Insuffiecient memory to add record  */</span>
<a name="l00179"></a><a class="code" href="mock_v_m_lib_nci_8h.html#abdd986eec09a87e74628d872c883f7c3">00179</a> };
<a name="l00180"></a>00180 <span class="keyword">typedef</span> uint8_t <a class="code" href="test_validate_n_f_c_8c.html#abdd986eec09a87e74628d872c883f7c3">tNDEF_STATUS</a>;
<a name="l00181"></a>00181 
<a name="l00182"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a993de5fd10bc53153444215db1c3fd73">00182</a> <span class="comment">/* Definitions for tNFA_TNF (NDEF type name format ID) */</span>
<a name="l00183"></a><a class="code" href="mock_v_m_lib_nci_8h.html#aa4a84b004f7d5148ddc328a1d8bd0e71">00183</a> <span class="preprocessor">#define NFA_TNF_EMPTY NDEF_TNF_EMPTY          </span><span class="comment">/* Empty or no type specified                       */</span>
<a name="l00184"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a8ee02e8cc8493adc094b79b302cb9dbf">00184</a> <span class="preprocessor">#define NFA_TNF_WKT NDEF_TNF_WKT              </span><span class="comment">/* NFC Forum well-known type [NFC RTD]              */</span>
<a name="l00185"></a><a class="code" href="mock_v_m_lib_nci_8h.html#ac8eac5e75b2507986874859356f3502a">00185</a> <span class="preprocessor">#define NFA_TNF_RFC2046_MEDIA NDEF_TNF_MEDIA  </span><span class="comment">/* Media-type as defined in RFC 2046 [RFC 2046] */</span>
<a name="l00186"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a58942a340ed48ed575a7b8cc74fbdbeb">00186</a> <span class="preprocessor">#define NFA_TNF_RFC3986_URI NDEF_TNF_URI      </span><span class="comment">/* Absolute URI as defined in RFC 3986 [RFC 3986]   */</span>
<a name="l00187"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a55d3a695b3f3830c18cb0d8584944838">00187</a> <span class="preprocessor">#define NFA_TNF_EXTERNAL NDEF_TNF_EXT         </span><span class="comment">/* NFC Forum external type [NFC RTD]                */</span>
<a name="l00188"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a2225b5bd423d260da8a9f3d488abd62d">00188</a> <span class="preprocessor">#define NFA_TNF_UNKNOWN case NDEF_TNF_UNKNOWN </span><span class="comment">/* Unknown */</span>
<a name="l00189"></a><a class="code" href="mock_v_m_lib_nci_8h.html#ac02f727e92b48d45434c2f055df63166">00189</a> <span class="preprocessor">#define NFA_TNF_UNCHANGED NDEF_TNF_UNCHANGED  </span><span class="comment">/* Unchanged */</span>
<a name="l00190"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a0e5629874da9205790c7c704454e6bb0">00190</a> <span class="preprocessor">#define NFA_TNF_RESERVED NDEF_TNF_RESERVED    </span><span class="comment">/* Reserved                                         */</span>
<a name="l00191"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a5313516bae559243ec72a217c259d817">00191</a> <span class="preprocessor">#define NFA_TNF_DEFAULT case 0xFF             </span><span class="comment">/* Used to register default NDEF type handler       */</span>
<a name="l00192"></a>00192 <span class="keyword">typedef</span> uint8_t <a class="code" href="test_validate_n_f_c_8c.html#a5313516bae559243ec72a217c259d817">tNFA_TNF</a>;
<a name="l00193"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a8e648ef021a550bb0e33dac06c4a4c85">00193</a> 
<a name="l00194"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a4de41b61ff5167ee0c6e71fefb30e11d">00194</a> <span class="preprocessor">#define NDEF_MB_MASK 0x80  </span><span class="comment">/* Message Begin */</span>
<a name="l00195"></a><a class="code" href="mock_v_m_lib_nci_8h.html#aebfcabf9af6a655782f82a0b6df46c9c">00195</a> <span class="preprocessor">#define NDEF_ME_MASK 0x40  </span><span class="comment">/* Message End */</span>
<a name="l00196"></a><a class="code" href="mock_v_m_lib_nci_8h.html#abc13e9e56ec8b350caf90291c9168730">00196</a> <span class="preprocessor">#define NDEF_CF_MASK 0x20  </span><span class="comment">/* Chunk Flag */</span>
<a name="l00197"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a42fdcabc01e68f6e8f1a4b8722ad6ed5">00197</a> <span class="preprocessor">#define NDEF_SR_MASK 0x10  </span><span class="comment">/* Short Record */</span>
<a name="l00198"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a8f30ac075554f1b4382736ef1961c693">00198</a> <span class="preprocessor">#define NDEF_IL_MASK 0x08  </span><span class="comment">/* ID Length */</span>
<a name="l00199"></a>00199 <span class="preprocessor">#define NDEF_TNF_MASK 0x07 </span><span class="comment">/* Type Name Format */</span>
<a name="l00200"></a>00200 
<a name="l00201"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a665ed7f810ea841ec0a1c3d1e9e2c8b1">00201</a> <span class="comment">/* NDEF Type Name Format */</span>
<a name="l00202"></a><a class="code" href="mock_v_m_lib_nci_8h.html#ae65c725ec8be7723876cdbbd16e0bb62">00202</a> <span class="preprocessor">#define NDEF_TNF_EMPTY 0     </span><span class="comment">/* Empty (type/id/payload len =0) */</span>
<a name="l00203"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a9cb3bf24f791c1a026d8fddb001a8fe4">00203</a> <span class="preprocessor">#define NDEF_TNF_WKT 1       </span><span class="comment">/* NFC Forum well-known type/RTD */</span>
<a name="l00204"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a11389e8d76a486636ecaf2ab056fe454">00204</a> <span class="preprocessor">#define NDEF_TNF_MEDIA 2     </span><span class="comment">/* Media-type as defined in RFC 2046 */</span>
<a name="l00205"></a><a class="code" href="mock_v_m_lib_nci_8h.html#abb23e12f1c5e5cc553d840bfca11e2cc">00205</a> <span class="preprocessor">#define NDEF_TNF_URI 3       </span><span class="comment">/* Absolute URI as defined in RFC 3986 */</span>
<a name="l00206"></a><a class="code" href="mock_v_m_lib_nci_8h.html#ae5795c78a50c7581bfc2b22b487f1421">00206</a> <span class="preprocessor">#define NDEF_TNF_EXT 4       </span><span class="comment">/* NFC Forum external type/RTD */</span>
<a name="l00207"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a69a4d012932da18e6f41bc15ee57b396">00207</a> <span class="preprocessor">#define NDEF_TNF_UNKNOWN 5   </span><span class="comment">/* Unknown (type len =0) */</span>
<a name="l00208"></a><a class="code" href="mock_v_m_lib_nci_8h.html#a969d99cc39108ae0874a582071c0cbb4">00208</a> <span class="preprocessor">#define NDEF_TNF_UNCHANGED 6 </span><span class="comment">/* Unchanged (type len =0) */</span>
<a name="l00209"></a>00209 <span class="preprocessor">#define NDEF_TNF_RESERVED 7  </span><span class="comment">/* Reserved */</span>
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="keywordtype">void</span> <a class="code" href="test_validate_n_f_c_8c.html#abed538836e5efabd161cb1650e25076a">createBufNdef_TypeURI</a>(uint8_t* strIN, <span class="keywordtype">int</span> sizLen, uint8_t* strOUT);
<a name="l00212"></a>00212 <span class="keywordtype">void</span> <a class="code" href="test_validate_n_f_c_8c.html#a8610a1d8823c030a9c6f32f3bed1d109">createBufNdef_TypeText</a>(uint8_t* strIN, <span class="keywordtype">int</span> sizLen, uint8_t* strOUT);
<a name="l00213"></a>00213 <span class="keywordtype">void</span> <a class="code" href="test_validate_n_f_c_8c.html#ac14c9224a66a2a89125aa85960049e75">createBufNdef_TypeSmartPoster</a>(uint8_t* strIN, uint8_t* strIN2, <span class="keywordtype">int</span> sizLen, uint8_t* strOUT);
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 <span class="keywordtype">void</span> <a class="code" href="test_validate_n_f_c_8c.html#ac1deab4cf4a6e808b1e8686b70c4ddf1">vshort_actidata</a>(uint8_t* strIN, <span class="keywordtype">int</span> sizLen, uint8_t* strOUT);
<a name="l00216"></a>00216 <span class="keywordtype">void</span> <a class="code" href="test_validate_n_f_c_8c.html#ad40071584d81f7b4eb479c63e725ef28">vshort_sendata</a>(uint8_t* strIN, <span class="keywordtype">int</span> sizLen, uint8_t* strOUT);
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="keywordtype">int</span> <a class="code" href="mock_v_m_lib_nci_8c.html#adff2d99b1fcbcac41dc153e9952f0731">codeNFC</a>(NfcPayload* nfcData, uint8_t* msg);
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 <span class="comment">/*******************************************************************************</span>
<a name="l00221"></a>00221 <span class="comment">**</span>
<a name="l00222"></a>00222 <span class="comment">** Function         NDEF_RecGetType</span>
<a name="l00223"></a>00223 <span class="comment">**</span>
<a name="l00224"></a>00224 <span class="comment">** Description      This function gets a pointer to the record type for the given NDEF record.</span>
<a name="l00225"></a>00225 <span class="comment">**</span>
<a name="l00226"></a>00226 <span class="comment">** Returns          Pointer to Type (NULL if none). TNF and len are filled in.</span>
<a name="l00227"></a>00227 <span class="comment">**</span>
<a name="l00228"></a>00228 <span class="comment">*******************************************************************************/</span>
<a name="l00229"></a>00229 uint8_t* <a class="code" href="test_validate_n_f_c_8c.html#a3f35f5ca513e33a2b3c1cbbe0e5d3ae1">NDEF_RecGetType</a>(uint8_t* p_rec, uint8_t* p_tnf, uint8_t* p_type_len);
<a name="l00230"></a>00230 
<a name="l00231"></a>00231 <span class="comment">/*******************************************************************************</span>
<a name="l00232"></a>00232 <span class="comment">**</span>
<a name="l00233"></a>00233 <span class="comment">** Function         NDEF_RecGetId</span>
<a name="l00234"></a>00234 <span class="comment">**</span>
<a name="l00235"></a>00235 <span class="comment">** Description      This function gets a pointer to the record id for the given NDEF record.</span>
<a name="l00236"></a>00236 <span class="comment">**</span>
<a name="l00237"></a>00237 <span class="comment">** Returns          Pointer to Id (NULL if none). ID Len is filled in.</span>
<a name="l00238"></a>00238 <span class="comment">**</span>
<a name="l00239"></a>00239 <span class="comment">*******************************************************************************/</span>
<a name="l00240"></a>00240 uint8_t* <a class="code" href="test_validate_n_f_c_8c.html#a36021f337036613ae2e4a54c4e983ebf">NDEF_RecGetId</a>(uint8_t* p_rec, uint8_t* p_id_len);
<a name="l00241"></a>00241 
<a name="l00242"></a>00242 <span class="comment">/*******************************************************************************</span>
<a name="l00243"></a>00243 <span class="comment">**</span>
<a name="l00244"></a>00244 <span class="comment">** Function         NDEF_RecGetPayload</span>
<a name="l00245"></a>00245 <span class="comment">**</span>
<a name="l00246"></a>00246 <span class="comment">** Description      This function gets a pointer to the payload for the given NDEF record.</span>
<a name="l00247"></a>00247 <span class="comment">**</span>
<a name="l00248"></a>00248 <span class="comment">** Returns          a pointer to the payload (or NULL none). Payload len filled in.</span>
<a name="l00249"></a>00249 <span class="comment">**</span>
<a name="l00250"></a>00250 <span class="comment">*******************************************************************************/</span>
<a name="l00251"></a>00251 uint8_t* <a class="code" href="test_validate_n_f_c_8c.html#a78a9a76f8c34cfb0611da2338c777fcf">NDEF_RecGetPayload</a>(uint8_t* p_rec, uint32_t* p_payload_len);
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="comment">/*******************************************************************************</span>
<a name="l00254"></a>00254 <span class="comment">**</span>
<a name="l00255"></a>00255 <span class="comment">** Function         NDEF_MsgValidate</span>
<a name="l00256"></a>00256 <span class="comment">**</span>
<a name="l00257"></a>00257 <span class="comment">** Description      This function validates an NDEF message.</span>
<a name="l00258"></a>00258 <span class="comment">**</span>
<a name="l00259"></a>00259 <span class="comment">** Returns          TRUE if all OK, or FALSE if the message is invalid.</span>
<a name="l00260"></a>00260 <span class="comment">**</span>
<a name="l00261"></a>00261 <span class="comment">*******************************************************************************/</span>
<a name="l00262"></a>00262 <a class="code" href="test_validate_n_f_c_8c.html#abdd986eec09a87e74628d872c883f7c3">tNDEF_STATUS</a> <a class="code" href="test_validate_n_f_c_8c.html#a9726a6dd82160b0f6f7d09e6231e4e68">NDEF_MsgValidate</a>(uint8_t* p_msg, uint32_t msg_len, <span class="keywordtype">int</span> b_allow_chunks);
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 24 2017 13:26:22 for AiCPlayer by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
