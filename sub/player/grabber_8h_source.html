<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>AiCPlayer: include/grabber.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">AiCPlayer
   
   </div>
   <div id="projectbrief">Interface of aic vm - for rendering aspect, sensors, video records</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Quick&#160;intro</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">include/grabber.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="grabber_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00009"></a>00009 <span class="preprocessor">#ifndef __GRABBER_H_</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span><span class="preprocessor">#define __GRABBER_H_</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;libavformat/avformat.h&gt;</span>  <span class="comment">// for AVStream</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;libavutil/frame.h&gt;</span>       <span class="comment">// for AVFrame</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;libswscale/swscale.h&gt;</span>    <span class="comment">// for SWS_BICUBIC</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;pthread.h&gt;</span>               <span class="comment">// for pthread_mutex_t, pthread_cond_t</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;stdint.h&gt;</span>                <span class="comment">// for uint8_t</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;X11/Xlib.h&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;<a class="code" href="buffer__sizes_8h.html" title="Define common buffer sizes.">buffer_sizes.h</a>&quot;</span>          <span class="comment">// for BUF_SIZE</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="socket_8h.html" title="Define socket utilities to simplify networking.">socket.h</a>&quot;</span>                <span class="comment">// for socket_t</span>
<a name="l00020"></a>00020 
<a name="l00022"></a><a class="code" href="grabber_8h.html#aac0f5f5e371c09dd0577ab8920985b84">00022</a> <span class="preprocessor">#define PORT_GRAB 32500</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span>
<a name="l00025"></a><a class="code" href="grabber_8h.html#ace0cad5fe744009aeaa62eb1fbb31831">00025</a> <span class="preprocessor">#define STREAM_DURATION 60.0</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span>
<a name="l00027"></a><a class="code" href="grabber_8h.html#ad0fa7a6ac51a4021276c0a04dfe2283b">00027</a> <span class="preprocessor">#define STREAM_FRAME_RATE 60</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span>
<a name="l00029"></a><a class="code" href="grabber_8h.html#ae67b157ab0198fa81bf675b378ff06fd">00029</a> <span class="preprocessor">#define STREAM_PIX_FMT AV_PIX_FMT_YUV420P</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00031"></a><a class="code" href="grabber_8h.html#ab746bcb79e75e498c4925ccd72a34f63">00031</a> <span class="preprocessor">#define SCALE_FLAGS SWS_BICUBIC</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00034"></a><a class="code" href="grabber_8h.html#a62a46cb032ba1774d8683906d23f4804">00034</a> <span class="preprocessor">#define CLIP(X) ((X) &gt; 255 ? 255 : (X) &lt; 0 ? 0 : X)</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span>
<a name="l00036"></a>00036 <span class="comment">// RGB -&gt; YUV</span>
<a name="l00037"></a><a class="code" href="grabber_8h.html#ac66a23de596019d370db55f052a1a928">00037</a> <span class="preprocessor">#define RGB2Y(R, G, B) CLIP(((66 * (R) + 129 * (G) + 25 * (B) + 128) &gt;&gt; 8) + 16)</span>
<a name="l00038"></a><a class="code" href="grabber_8h.html#afae87ec6290bb8ebc1c6c88a97916283">00038</a> <span class="preprocessor"></span><span class="preprocessor">#define RGB2U(R, G, B) CLIP(((-38 * (R) -74 * (G) + 112 * (B) + 128) &gt;&gt; 8) + 128)</span>
<a name="l00039"></a><a class="code" href="grabber_8h.html#a6421f7fac9f0415adc6b4403b26c5d02">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define RGB2V(R, G, B) CLIP(((112 * (R) -94 * (G) -18 * (B) + 128) &gt;&gt; 8) + 128)</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00042"></a>00042 
<a name="l00046"></a><a class="code" href="structread__args.html">00046</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structread__args.html" title="Shared structure between recv thread and grabber thread.">read_args</a>
<a name="l00047"></a>00047 {
<a name="l00048"></a><a class="code" href="structread__args.html#a2680f9fe5653a596c7e779b838180fdc">00048</a>     pthread_mutex_t <a class="code" href="structread__args.html#a2680f9fe5653a596c7e779b838180fdc">mtx</a>;
<a name="l00049"></a><a class="code" href="structread__args.html#a0a1433271fddfed84bc959ae6c202e5a">00049</a>     pthread_cond_t <a class="code" href="structread__args.html#a0a1433271fddfed84bc959ae6c202e5a">cond</a>;
<a name="l00050"></a><a class="code" href="structread__args.html#a56ed84df35de10bdb65e72b184309497">00050</a>     uint8_t* <a class="code" href="structread__args.html#a56ed84df35de10bdb65e72b184309497">buffer</a>;
<a name="l00051"></a><a class="code" href="structread__args.html#a38e99abf9c2b5702286500209c26a350">00051</a>     <a class="code" href="socket_8h.html#a30353f381f5fccbb956eea1f3a110b6c" title="Alias to differenciate between regular ints and socket fds.">socket_t</a> <a class="code" href="structread__args.html#a38e99abf9c2b5702286500209c26a350">sock</a>;
<a name="l00052"></a><a class="code" href="structread__args.html#afed088663f8704004425cdae2120b9b3">00052</a>     <span class="keywordtype">int</span> <a class="code" href="structread__args.html#afed088663f8704004425cdae2120b9b3">len</a>;
<a name="l00053"></a><a class="code" href="structread__args.html#a396861ea89017d220b9303a8b1eb7718">00053</a>     <span class="keywordtype">int</span> <a class="code" href="structread__args.html#a396861ea89017d220b9303a8b1eb7718">flagSnapRec</a>;
<a name="l00054"></a><a class="code" href="structread__args.html#a4ff465ddd4cef53f00d79cd3636e07d5">00054</a>     <span class="keywordtype">int</span> <a class="code" href="structread__args.html#a4ff465ddd4cef53f00d79cd3636e07d5">flagRecording</a>;
<a name="l00055"></a>00055 } <a class="code" href="grabber_8h.html#af80f4bf8baf8f9d60338cdc6297be477" title="Shared structure between recv thread and grabber thread.">s_read_args</a>;
<a name="l00056"></a>00056 
<a name="l00060"></a><a class="code" href="structthread__args.html">00060</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structthread__args.html" title="Struct holding the state of a recording (filename/lock)">thread_args</a>
<a name="l00061"></a>00061 {
<a name="l00062"></a><a class="code" href="structthread__args.html#a2680f9fe5653a596c7e779b838180fdc">00062</a>     pthread_mutex_t <a class="code" href="structthread__args.html#a2680f9fe5653a596c7e779b838180fdc">mtx</a>;
<a name="l00063"></a><a class="code" href="structthread__args.html#af2c4d6043e95a7869af5452ca61118a9">00063</a>     <span class="keywordtype">char</span> <a class="code" href="structthread__args.html#af2c4d6043e95a7869af5452ca61118a9">record_filename</a>[<a class="code" href="buffer__sizes_8h.html#a6821bafc3c88dfb2e433a095df9940c6" title="Small, fixed-size buffers.">BUF_SIZE</a>];
<a name="l00064"></a>00064 } <a class="code" href="grabber_8h.html#a9fd81a27615c742851fe52691323ea30" title="Struct holding the state of a recording (filename/lock)">s_thread_args</a>;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="keywordtype">void</span> <a class="code" href="grabber_8h.html#a48f6cd7606f077585e21d8aec736a1ee">grab_snapshot</a>(<span class="keywordtype">char</span>* snap_filename);
<a name="l00067"></a>00067 
<a name="l00069"></a><a class="code" href="struct_output_stream.html">00069</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_output_stream.html" title="A wrapper around a single output AVStream.">OutputStream</a>
<a name="l00070"></a>00070 {
<a name="l00071"></a><a class="code" href="struct_output_stream.html#a639f7fc9c8c402c8d05dcccdd0ce1e3d">00071</a>     AVStream* <a class="code" href="struct_output_stream.html#a639f7fc9c8c402c8d05dcccdd0ce1e3d">st</a>;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073     <span class="comment">/* pts of the next frame that will be generated */</span>
<a name="l00074"></a><a class="code" href="struct_output_stream.html#a891a60796c8de143b294f6d672cecd2f">00074</a>     int64_t <a class="code" href="struct_output_stream.html#a891a60796c8de143b294f6d672cecd2f">next_pts</a>;
<a name="l00075"></a><a class="code" href="struct_output_stream.html#a9fc04c8a9ecf9919aa8c54bc92c1c157">00075</a>     <span class="keywordtype">int</span> <a class="code" href="struct_output_stream.html#a9fc04c8a9ecf9919aa8c54bc92c1c157">samples_count</a>;
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="struct_output_stream.html#a6dd0a0f396f08a0eaf19b5cbd9150e57">00077</a>     AVFrame* <a class="code" href="struct_output_stream.html#a6dd0a0f396f08a0eaf19b5cbd9150e57">frame</a>;
<a name="l00078"></a><a class="code" href="struct_output_stream.html#a0690656434bffb52604eb563b9165b67">00078</a>     AVFrame* <a class="code" href="struct_output_stream.html#a0690656434bffb52604eb563b9165b67">tmp_frame</a>;
<a name="l00079"></a>00079 
<a name="l00080"></a><a class="code" href="struct_output_stream.html#ae3371cbe1ab70a16f1b58241d289ae77">00080</a>     <span class="keywordtype">float</span> <a class="code" href="struct_output_stream.html#afea36502e9d227ff62c5fb2719a246f2">t</a>, <a class="code" href="struct_output_stream.html#a2d8bac9bbefeaba3b68329c0d5e476d8">tincr</a>, <a class="code" href="struct_output_stream.html#ae3371cbe1ab70a16f1b58241d289ae77">tincr2</a>;
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="struct_output_stream.html#a892e7e7975303116d7b32c5dd09d3da8">00082</a>     <span class="keyword">struct </span>SwsContext* <a class="code" href="struct_output_stream.html#a892e7e7975303116d7b32c5dd09d3da8">sws_ctx</a>;
<a name="l00083"></a><a class="code" href="struct_output_stream.html#aa15007daa176c3c749e1aef145194a22">00083</a>     <span class="keyword">struct </span>SwrContext* <a class="code" href="struct_output_stream.html#aa15007daa176c3c749e1aef145194a22">swr_ctx</a>;
<a name="l00084"></a>00084 } <a class="code" href="grabber_8h.html#aa830feff7a9a708ebf88c49e3d33efb1" title="A wrapper around a single output AVStream.">OutputStream</a>;
<a name="l00085"></a>00085 
<a name="l00091"></a>00091 <span class="keywordtype">int</span> <a class="code" href="grabber_8h.html#a0497bd4df0c871e0997655fd69f32cd6" title="Function passed to a thread in order to detect format encoding - encode frame- and write in a file...">ffmpeg_grabber</a>(<span class="keywordtype">void</span>* arg);
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="grabber_8h.html#a19b9c3e3148b8222a01aa071b54d5237">xgrabber</a>();
<a name="l00094"></a>00094 
<a name="l00099"></a>00099 <span class="keywordtype">void</span>* <a class="code" href="grabber_8h.html#a9d9ad64cb39218bf4bd0f000fde19558" title="Start/Stop from socket connection via protobuf message.">grab_handler_sock</a>();
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="keywordtype">void</span>* <a class="code" href="grabber_8h.html#a59a47331bd2c7708cc7aa10a2f1f5bbc">grab_handler_amqp</a>(<span class="keywordtype">void</span>* args);
<a name="l00102"></a>00102 
<a name="l00106"></a>00106 <span class="keywordtype">void</span> <a class="code" href="grabber_8h.html#aedfbbbd02a0acd665e2d4acb36ff73b1" title="Set the static path to the screenshots/movies dir.">grabber_set_path_results</a>(<span class="keywordtype">char</span>* results);
<a name="l00107"></a>00107 
<a name="l00111"></a>00111 <span class="keywordtype">void</span> <a class="code" href="grabber_8h.html#a74b78220ef8602f9341bed3375e9b20a" title="Set the static X display pointer.">grabber_set_display</a>(Display* display);
<a name="l00112"></a>00112 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 24 2017 14:07:03 for AiCPlayer by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
