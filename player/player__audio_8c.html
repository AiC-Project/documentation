<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>AiCPlayer: src/player_audio.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">AiCPlayer
   
   </div>
   <div id="projectbrief">Interface of aic vm - for rendering aspect, sensors, video records</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Quick&#160;intro</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">src/player_audio.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>AiC audio player, reads an audio stream from the vm and transfers it to ffmpeg.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;libavcodec/avcodec.h&gt;</code><br/>
<code>#include &lt;libavutil/avassert.h&gt;</code><br/>
<code>#include &lt;libavutil/avutil.h&gt;</code><br/>
<code>#include &lt;libavutil/channel_layout.h&gt;</code><br/>
<code>#include &lt;libavutil/common.h&gt;</code><br/>
<code>#include &lt;libavutil/dict.h&gt;</code><br/>
<code>#include &lt;libavutil/error.h&gt;</code><br/>
<code>#include &lt;libavutil/mem.h&gt;</code><br/>
<code>#include &lt;libavutil/rational.h&gt;</code><br/>
<code>#include &lt;libavutil/samplefmt.h&gt;</code><br/>
<code>#include &lt;libswresample/swresample.h&gt;</code><br/>
<code>#include &lt;libswscale/swscale.h&gt;</code><br/>
<code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;libavformat/avformat.h&gt;</code><br/>
<code>#include &lt;libavformat/avio.h&gt;</code><br/>
<code>#include &lt;libavutil/audio_fifo.h&gt;</code><br/>
<code>#include &lt;libavutil/frame.h&gt;</code><br/>
<code>#include &lt;libavutil/opt.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="socket_8h_source.html">socket.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="logger_8h_source.html">logger.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="config__env_8h_source.html">config_env.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for player_audio.c:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c__incl.png" border="0" usemap="#src_2player__audio_8c" alt=""/></div>
<map name="src_2player__audio_8c" id="src_2player__audio_8c">
<area shape="rect" id="node49" href="socket_8h.html" title="Define socket utilities to simplify networking." alt="" coords="3171,83,3243,112"/><area shape="rect" id="node53" href="logger_8h.html" title="Logging macros." alt="" coords="3267,83,3333,112"/><area shape="rect" id="node57" href="config__env_8h.html" title="Utilities to get config values from the environment." alt="" coords="3357,83,3453,112"/></map>
</div>
</div>
<p><a href="player__audio_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_output_stream.html">OutputStream</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A wrapper around a single output AVStream.  <a href="struct_output_stream.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#a7ce0df38eb467e59f209470c8f5ac4e6">LOG_TAG</a>&#160;&#160;&#160;&quot;audio&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#aa50beefd3bccf37791e8b82ad43b3e38">ANDROIDINCLOUD_PCM_CLIENT_PORT</a>&#160;&#160;&#160;24296</td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_output_stream.html">OutputStream</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#aa830feff7a9a708ebf88c49e3d33efb1">OutputStream</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa">get_error_text</a> (const int error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#abc8ec9c5260ec70ecebb37cbcb746394">init_packet</a> (AVPacket *packet)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#a63d73c3f3e7891f9a4592e92d39abfcd">init_input_frame</a> (AVFrame **frame)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#a7ee8b4fa5255ba1e25decc9d96b5a983">init_resampler</a> (AVCodecContext *input_codec_context, AVCodecContext *output_codec_context, SwrContext **resample_context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#a88f220faad1baa2753ed61330971ce07">init_fifo</a> (AVAudioFifo **fifo, AVCodecContext *output_codec_context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#aac28838d760bc5bd9fa65cadd10d73cf">decode_audio_frame</a> (AVFrame *frame, AVFormatContext *input_format_context, AVCodecContext *input_codec_context, int *data_present, int *finished)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#a22ab1e8a1d6f3fac1f0846c372fddcaa">init_converted_samples</a> (uint8_t ***converted_input_samples, AVCodecContext *output_codec_context, int frame_size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#a06ae67b30527ba39c9683a73987b88bd">convert_samples</a> (const uint8_t **input_data, uint8_t **converted_data, const int frame_size, SwrContext *resample_context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#ae26b4b320a7995565d0fb085db4d788b">add_samples_to_fifo</a> (AVAudioFifo *fifo, uint8_t **converted_input_samples, const int frame_size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#ae0deb6480c1c387f2035f2ddb91f8b14">init_output_frame</a> (AVFrame **frame, AVCodecContext *output_codec_context, int frame_size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#a5357f230b8fd19ed3c04233e49316c8b">encode_audio_frame</a> (AVFrame *frame, AVFormatContext *output_format_context, AVCodecContext *output_codec_context, int *data_present)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#a1fd0150c4090f6a008d8a8fafcff62d8">load_encode_and_write</a> (AVAudioFifo *fifo, AVFormatContext *output_format_context, AVCodecContext *output_codec_context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#af16360dc3fbd73cf6d2ee8415449bc63">write_output_file_trailer</a> (AVFormatContext *output_format_context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb">audiolive_decode_encode</a> (AVFormatContext *oc, <a class="el" href="struct_output_stream.html">OutputStream</a> *ost, unsigned char *inbuf, int num_read, int size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#aee1ca14a933f54d8d70fcd22a2a8ece1">aic_audioplayer</a> (char *vmip)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="player__audio_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>AiC audio player, reads an audio stream from the vm and transfers it to ffmpeg. </p>
<p>Based on ffmpeg API examples.. </p>

<p>Definition in file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="aa50beefd3bccf37791e8b82ad43b3e38"></a><!-- doxytag: member="player_audio.c::ANDROIDINCLOUD_PCM_CLIENT_PORT" ref="aa50beefd3bccf37791e8b82ad43b3e38" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="player__audio_8c.html#aa50beefd3bccf37791e8b82ad43b3e38">ANDROIDINCLOUD_PCM_CLIENT_PORT</a>&#160;&#160;&#160;24296</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Port open on the VM </p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00039">39</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7ce0df38eb467e59f209470c8f5ac4e6"></a><!-- doxytag: member="player_audio.c::LOG_TAG" ref="a7ce0df38eb467e59f209470c8f5ac4e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="test_sensors_8c.html#a7ce0df38eb467e59f209470c8f5ac4e6">LOG_TAG</a>&#160;&#160;&#160;&quot;audio&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00036">36</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="aa830feff7a9a708ebf88c49e3d33efb1"></a><!-- doxytag: member="player_audio.c::OutputStream" ref="aa830feff7a9a708ebf88c49e3d33efb1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_output_stream.html">OutputStream</a>  <a class="el" href="struct_output_stream.html">OutputStream</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae26b4b320a7995565d0fb085db4d788b"></a><!-- doxytag: member="player_audio.c::add_samples_to_fifo" ref="ae26b4b320a7995565d0fb085db4d788b" args="(AVAudioFifo *fifo, uint8_t **converted_input_samples, const int frame_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="player__audio_8c.html#ae26b4b320a7995565d0fb085db4d788b">add_samples_to_fifo</a> </td>
          <td>(</td>
          <td class="paramtype">AVAudioFifo *&#160;</td>
          <td class="paramname"><em>fifo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>converted_input_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>frame_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Add converted input audio samples to the FIFO buffer for later processing. </p>
<p>Make the FIFO as large as it needs to be to hold both, the old and the new samples.</p>
<p>Store the new samples in the FIFO buffer. </p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00231">231</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_ae26b4b320a7995565d0fb085db4d788b_icgraph.png" border="0" usemap="#player__audio_8c_ae26b4b320a7995565d0fb085db4d788b_icgraph" alt=""/></div>
<map name="player__audio_8c_ae26b4b320a7995565d0fb085db4d788b_icgraph" id="player__audio_8c_ae26b4b320a7995565d0fb085db4d788b_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb" title="audiolive_decode_encode" alt="" coords="197,5,368,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aee1ca14a933f54d8d70fcd22a2a8ece1"></a><!-- doxytag: member="player_audio.c::aic_audioplayer" ref="aee1ca14a933f54d8d70fcd22a2a8ece1" args="(char *vmip)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* <a class="el" href="player__audio_8c.html#aee1ca14a933f54d8d70fcd22a2a8ece1">aic_audioplayer</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>vmip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00784">784</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_aee1ca14a933f54d8d70fcd22a2a8ece1_cgraph.png" border="0" usemap="#player__audio_8c_aee1ca14a933f54d8d70fcd22a2a8ece1_cgraph" alt=""/></div>
<map name="player__audio_8c_aee1ca14a933f54d8d70fcd22a2a8ece1_cgraph" id="player__audio_8c_aee1ca14a933f54d8d70fcd22a2a8ece1_cgraph">
<area shape="rect" id="node3" href="socket_8h.html#a548f0ed12e49a65bf1a6b62c0d30ccab" title="Connect to a host:port couple." alt="" coords="196,5,292,35"/><area shape="rect" id="node5" href="player__audio_8c.html#af16360dc3fbd73cf6d2ee8415449bc63" title="write_output_file_trailer" alt="" coords="167,59,321,88"/><area shape="rect" id="node7" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa" title="get_error_text" alt="" coords="372,59,473,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_aee1ca14a933f54d8d70fcd22a2a8ece1_icgraph.png" border="0" usemap="#player__audio_8c_aee1ca14a933f54d8d70fcd22a2a8ece1_icgraph" alt=""/></div>
<map name="player__audio_8c_aee1ca14a933f54d8d70fcd22a2a8ece1_icgraph" id="player__audio_8c_aee1ca14a933f54d8d70fcd22a2a8ece1_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="main" alt="" coords="165,5,216,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4f9b8b73acff764504b43cbb04cdbaeb"></a><!-- doxytag: member="player_audio.c::audiolive_decode_encode" ref="a4f9b8b73acff764504b43cbb04cdbaeb" args="(AVFormatContext *oc, OutputStream *ost, unsigned char *inbuf, int num_read, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb">audiolive_decode_encode</a> </td>
          <td>(</td>
          <td class="paramtype">AVFormatContext *&#160;</td>
          <td class="paramname"><em>oc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_output_stream.html">OutputStream</a> *&#160;</td>
          <td class="paramname"><em>ost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>inbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Use the encoder's desired frame size for processing.</p>
<p>Make sure that there is one frame worth of samples in the FIFO buffer so that the encoder can do its work. Since the decoder's and the encoder's frame size may differ, we need to FIFO buffer to store as many frames worth of input samples that they make up at least one frame worth of output samples.</p>
<p>Decode one frame worth of audio samples, convert it to the output sample format and put it into the FIFO buffer.</p>
<p>Convert the input samples to the desired output sample format. This requires a temporary storage provided by converted_input_samples.</p>
<p>Add the converted input samples to the FIFO buffer for later processing.</p>
<p>If we are at the end of the input file, we continue encoding the remaining audio samples to the output file.</p>
<p>If we have enough samples for the encoder, we encode them. At the end of the file, we pass the remaining samples to the encoder.</p>
<p>Take one frame worth of audio samples from the FIFO buffer, encode it and write it to the output file.</p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00576">576</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_a4f9b8b73acff764504b43cbb04cdbaeb_cgraph.png" border="0" usemap="#player__audio_8c_a4f9b8b73acff764504b43cbb04cdbaeb_cgraph" alt=""/></div>
<map name="player__audio_8c_a4f9b8b73acff764504b43cbb04cdbaeb_cgraph" id="player__audio_8c_a4f9b8b73acff764504b43cbb04cdbaeb_cgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#a88f220faad1baa2753ed61330971ce07" title="init_fifo" alt="" coords="272,5,336,35"/><area shape="rect" id="node5" href="player__audio_8c.html#a7ee8b4fa5255ba1e25decc9d96b5a983" title="init_resampler" alt="" coords="253,59,355,88"/><area shape="rect" id="node7" href="player__audio_8c.html#a22ab1e8a1d6f3fac1f0846c372fddcaa" title="init_converted_samples" alt="" coords="433,109,591,139"/><area shape="rect" id="node11" href="player__audio_8c.html#a06ae67b30527ba39c9683a73987b88bd" title="convert_samples" alt="" coords="452,163,572,192"/><area shape="rect" id="node14" href="player__audio_8c.html#ae26b4b320a7995565d0fb085db4d788b" title="add_samples_to_fifo" alt="" coords="233,213,375,243"/><area shape="rect" id="node16" href="player__audio_8c.html#a1fd0150c4090f6a008d8a8fafcff62d8" title="load_encode_and_write" alt="" coords="225,267,383,296"/><area shape="rect" id="node9" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa" title="get_error_text" alt="" coords="641,189,743,219"/><area shape="rect" id="node18" href="player__audio_8c.html#ae0deb6480c1c387f2035f2ddb91f8b14" title="init_output_frame" alt="" coords="451,216,573,245"/><area shape="rect" id="node21" href="player__audio_8c.html#a5357f230b8fd19ed3c04233e49316c8b" title="encode_audio_frame" alt="" coords="441,269,583,299"/><area shape="rect" id="node23" href="player__audio_8c.html#abc8ec9c5260ec70ecebb37cbcb746394" title="init_packet" alt="" coords="649,269,735,299"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a06ae67b30527ba39c9683a73987b88bd"></a><!-- doxytag: member="player_audio.c::convert_samples" ref="a06ae67b30527ba39c9683a73987b88bd" args="(const uint8_t **input_data, uint8_t **converted_data, const int frame_size, SwrContext *resample_context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="player__audio_8c.html#a06ae67b30527ba39c9683a73987b88bd">convert_samples</a> </td>
          <td>(</td>
          <td class="paramtype">const uint8_t **&#160;</td>
          <td class="paramname"><em>input_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>converted_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>frame_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SwrContext *&#160;</td>
          <td class="paramname"><em>resample_context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Convert the input audio samples into the output sample format. The conversion happens on a per-frame basis, the size of which is specified by frame_size. </p>
<p>Convert the samples using the resampler. </p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00214">214</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_a06ae67b30527ba39c9683a73987b88bd_cgraph.png" border="0" usemap="#player__audio_8c_a06ae67b30527ba39c9683a73987b88bd_cgraph" alt=""/></div>
<map name="player__audio_8c_a06ae67b30527ba39c9683a73987b88bd_cgraph" id="player__audio_8c_a06ae67b30527ba39c9683a73987b88bd_cgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa" title="get_error_text" alt="" coords="177,5,279,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_a06ae67b30527ba39c9683a73987b88bd_icgraph.png" border="0" usemap="#player__audio_8c_a06ae67b30527ba39c9683a73987b88bd_icgraph" alt=""/></div>
<map name="player__audio_8c_a06ae67b30527ba39c9683a73987b88bd_icgraph" id="player__audio_8c_a06ae67b30527ba39c9683a73987b88bd_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb" title="audiolive_decode_encode" alt="" coords="176,5,347,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aac28838d760bc5bd9fa65cadd10d73cf"></a><!-- doxytag: member="player_audio.c::decode_audio_frame" ref="aac28838d760bc5bd9fa65cadd10d73cf" args="(AVFrame *frame, AVFormatContext *input_format_context, AVCodecContext *input_codec_context, int *data_present, int *finished)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="player__audio_8c.html#aac28838d760bc5bd9fa65cadd10d73cf">decode_audio_frame</a> </td>
          <td>(</td>
          <td class="paramtype">AVFrame *&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AVFormatContext *&#160;</td>
          <td class="paramname"><em>input_format_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AVCodecContext *&#160;</td>
          <td class="paramname"><em>input_codec_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>data_present</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>finished</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decode one audio frame from the input file. </p>
<p>Packet used for temporary storage.</p>
<p>Read one audio frame from the input file into a temporary packet.</p>
<p>If we are at the end of the file, flush the decoder below.</p>
<p>Decode the audio frame stored in the temporary packet. The input audio stream decoder is used to do this. If we are at the end of the file, pass an empty packet to the decoder to flush it.</p>
<p>If the decoder has not been flushed completely, we are not finished, so that this function has to be called again.</p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00126">126</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_aac28838d760bc5bd9fa65cadd10d73cf_cgraph.png" border="0" usemap="#player__audio_8c_aac28838d760bc5bd9fa65cadd10d73cf_cgraph" alt=""/></div>
<map name="player__audio_8c_aac28838d760bc5bd9fa65cadd10d73cf_cgraph" id="player__audio_8c_aac28838d760bc5bd9fa65cadd10d73cf_cgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#abc8ec9c5260ec70ecebb37cbcb746394" title="init_packet" alt="" coords="207,5,292,35"/><area shape="rect" id="node5" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa" title="get_error_text" alt="" coords="199,59,300,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5357f230b8fd19ed3c04233e49316c8b"></a><!-- doxytag: member="player_audio.c::encode_audio_frame" ref="a5357f230b8fd19ed3c04233e49316c8b" args="(AVFrame *frame, AVFormatContext *output_format_context, AVCodecContext *output_codec_context, int *data_present)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="player__audio_8c.html#a5357f230b8fd19ed3c04233e49316c8b">encode_audio_frame</a> </td>
          <td>(</td>
          <td class="paramtype">AVFrame *&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AVFormatContext *&#160;</td>
          <td class="paramname"><em>output_format_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AVCodecContext *&#160;</td>
          <td class="paramname"><em>output_codec_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>data_present</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode one frame worth of audio to the output file. </p>
<p>Packet used for temporary storage.</p>
<p>Set a timestamp based on the sample rate for the container.</p>
<p>Encode the audio frame and store it in the temporary packet. The output audio stream encoder is used to do this.</p>
<p>Write one audio frame from the temporary packet to the output file. </p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00299">299</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_a5357f230b8fd19ed3c04233e49316c8b_cgraph.png" border="0" usemap="#player__audio_8c_a5357f230b8fd19ed3c04233e49316c8b_cgraph" alt=""/></div>
<map name="player__audio_8c_a5357f230b8fd19ed3c04233e49316c8b_cgraph" id="player__audio_8c_a5357f230b8fd19ed3c04233e49316c8b_cgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#abc8ec9c5260ec70ecebb37cbcb746394" title="init_packet" alt="" coords="207,5,292,35"/><area shape="rect" id="node5" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa" title="get_error_text" alt="" coords="199,59,300,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_a5357f230b8fd19ed3c04233e49316c8b_icgraph.png" border="0" usemap="#player__audio_8c_a5357f230b8fd19ed3c04233e49316c8b_icgraph" alt=""/></div>
<map name="player__audio_8c_a5357f230b8fd19ed3c04233e49316c8b_icgraph" id="player__audio_8c_a5357f230b8fd19ed3c04233e49316c8b_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#a1fd0150c4090f6a008d8a8fafcff62d8" title="load_encode_and_write" alt="" coords="199,5,356,35"/><area shape="rect" id="node5" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb" title="audiolive_decode_encode" alt="" coords="405,5,576,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa51efe8890c8ebdfedfacbf61a13f7aa"></a><!-- doxytag: member="player_audio.c::get_error_text" ref="aa51efe8890c8ebdfedfacbf61a13f7aa" args="(const int error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa">get_error_text</a> </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>error</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00041">41</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_aa51efe8890c8ebdfedfacbf61a13f7aa_icgraph.png" border="0" usemap="#player__audio_8c_aa51efe8890c8ebdfedfacbf61a13f7aa_icgraph" alt=""/></div>
<map name="player__audio_8c_aa51efe8890c8ebdfedfacbf61a13f7aa_icgraph" id="player__audio_8c_aa51efe8890c8ebdfedfacbf61a13f7aa_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#aac28838d760bc5bd9fa65cadd10d73cf" title="decode_audio_frame" alt="" coords="165,5,307,35"/><area shape="rect" id="node5" href="player__audio_8c.html#a22ab1e8a1d6f3fac1f0846c372fddcaa" title="init_converted_samples" alt="" coords="364,56,521,85"/><area shape="rect" id="node9" href="player__audio_8c.html#a06ae67b30527ba39c9683a73987b88bd" title="convert_samples" alt="" coords="383,109,503,139"/><area shape="rect" id="node12" href="player__audio_8c.html#ae0deb6480c1c387f2035f2ddb91f8b14" title="init_output_frame" alt="" coords="175,160,297,189"/><area shape="rect" id="node17" href="player__audio_8c.html#a5357f230b8fd19ed3c04233e49316c8b" title="encode_audio_frame" alt="" coords="165,213,307,243"/><area shape="rect" id="node20" href="player__audio_8c.html#af16360dc3fbd73cf6d2ee8415449bc63" title="write_output_file_trailer" alt="" coords="159,267,313,296"/><area shape="rect" id="node7" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb" title="audiolive_decode_encode" alt="" coords="571,109,741,139"/><area shape="rect" id="node14" href="player__audio_8c.html#a1fd0150c4090f6a008d8a8fafcff62d8" title="load_encode_and_write" alt="" coords="364,163,521,192"/><area shape="rect" id="node22" href="player__audio_8c.html#aee1ca14a933f54d8d70fcd22a2a8ece1" title="aic_audioplayer" alt="" coords="387,267,499,296"/><area shape="rect" id="node24" href="player__audio_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="main" alt="" coords="631,267,681,296"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a22ab1e8a1d6f3fac1f0846c372fddcaa"></a><!-- doxytag: member="player_audio.c::init_converted_samples" ref="a22ab1e8a1d6f3fac1f0846c372fddcaa" args="(uint8_t ***converted_input_samples, AVCodecContext *output_codec_context, int frame_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="player__audio_8c.html#a22ab1e8a1d6f3fac1f0846c372fddcaa">init_converted_samples</a> </td>
          <td>(</td>
          <td class="paramtype">uint8_t ***&#160;</td>
          <td class="paramname"><em>converted_input_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AVCodecContext *&#160;</td>
          <td class="paramname"><em>output_codec_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>frame_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize a temporary storage for the specified number of audio samples. The conversion requires temporary storage due to the different format. The number of audio samples to be allocated is specified in frame_size. </p>
<p>Allocate as many pointers as there are audio channels. Each pointer will later point to the audio samples of the corresponding channels (although it may be NULL for interleaved formats).</p>
<p>Allocate memory for the samples of all channels in one consecutive block for convenience.</p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00176">176</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_a22ab1e8a1d6f3fac1f0846c372fddcaa_cgraph.png" border="0" usemap="#player__audio_8c_a22ab1e8a1d6f3fac1f0846c372fddcaa_cgraph" alt=""/></div>
<map name="player__audio_8c_a22ab1e8a1d6f3fac1f0846c372fddcaa_cgraph" id="player__audio_8c_a22ab1e8a1d6f3fac1f0846c372fddcaa_cgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa" title="get_error_text" alt="" coords="215,5,316,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_a22ab1e8a1d6f3fac1f0846c372fddcaa_icgraph.png" border="0" usemap="#player__audio_8c_a22ab1e8a1d6f3fac1f0846c372fddcaa_icgraph" alt=""/></div>
<map name="player__audio_8c_a22ab1e8a1d6f3fac1f0846c372fddcaa_icgraph" id="player__audio_8c_a22ab1e8a1d6f3fac1f0846c372fddcaa_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb" title="audiolive_decode_encode" alt="" coords="213,5,384,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a88f220faad1baa2753ed61330971ce07"></a><!-- doxytag: member="player_audio.c::init_fifo" ref="a88f220faad1baa2753ed61330971ce07" args="(AVAudioFifo **fifo, AVCodecContext *output_codec_context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="player__audio_8c.html#a88f220faad1baa2753ed61330971ce07">init_fifo</a> </td>
          <td>(</td>
          <td class="paramtype">AVAudioFifo **&#160;</td>
          <td class="paramname"><em>fifo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AVCodecContext *&#160;</td>
          <td class="paramname"><em>output_codec_context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize a FIFO buffer for the audio samples to be encoded. </p>
<p>Create the FIFO buffer based on the specified output sample format. </p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00113">113</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_a88f220faad1baa2753ed61330971ce07_icgraph.png" border="0" usemap="#player__audio_8c_a88f220faad1baa2753ed61330971ce07_icgraph" alt=""/></div>
<map name="player__audio_8c_a88f220faad1baa2753ed61330971ce07_icgraph" id="player__audio_8c_a88f220faad1baa2753ed61330971ce07_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb" title="audiolive_decode_encode" alt="" coords="117,5,288,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a63d73c3f3e7891f9a4592e92d39abfcd"></a><!-- doxytag: member="player_audio.c::init_input_frame" ref="a63d73c3f3e7891f9a4592e92d39abfcd" args="(AVFrame **frame)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="player__audio_8c.html#a63d73c3f3e7891f9a4592e92d39abfcd">init_input_frame</a> </td>
          <td>(</td>
          <td class="paramtype">AVFrame **&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize one audio frame for reading from the input file </p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00058">58</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae0deb6480c1c387f2035f2ddb91f8b14"></a><!-- doxytag: member="player_audio.c::init_output_frame" ref="ae0deb6480c1c387f2035f2ddb91f8b14" args="(AVFrame **frame, AVCodecContext *output_codec_context, int frame_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="player__audio_8c.html#ae0deb6480c1c387f2035f2ddb91f8b14">init_output_frame</a> </td>
          <td>(</td>
          <td class="paramtype">AVFrame **&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AVCodecContext *&#160;</td>
          <td class="paramname"><em>output_codec_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>frame_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize one input frame for writing to the output file. The frame will be exactly frame_size samples large. </p>
<p>Create a new frame to store the audio samples.</p>
<p>Set the frame's parameters, especially its size and format. av_frame_get_buffer needs this to allocate memory for the audio samples of the frame. Default channel layouts based on the number of channels are assumed for simplicity.</p>
<p>Allocate the samples of the created frame. This call will make sure that the audio frame can hold as many samples as specified.</p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00258">258</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_ae0deb6480c1c387f2035f2ddb91f8b14_cgraph.png" border="0" usemap="#player__audio_8c_ae0deb6480c1c387f2035f2ddb91f8b14_cgraph" alt=""/></div>
<map name="player__audio_8c_ae0deb6480c1c387f2035f2ddb91f8b14_cgraph" id="player__audio_8c_ae0deb6480c1c387f2035f2ddb91f8b14_cgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa" title="get_error_text" alt="" coords="177,5,279,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_ae0deb6480c1c387f2035f2ddb91f8b14_icgraph.png" border="0" usemap="#player__audio_8c_ae0deb6480c1c387f2035f2ddb91f8b14_icgraph" alt=""/></div>
<map name="player__audio_8c_ae0deb6480c1c387f2035f2ddb91f8b14_icgraph" id="player__audio_8c_ae0deb6480c1c387f2035f2ddb91f8b14_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#a1fd0150c4090f6a008d8a8fafcff62d8" title="load_encode_and_write" alt="" coords="177,5,335,35"/><area shape="rect" id="node5" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb" title="audiolive_decode_encode" alt="" coords="384,5,555,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abc8ec9c5260ec70ecebb37cbcb746394"></a><!-- doxytag: member="player_audio.c::init_packet" ref="abc8ec9c5260ec70ecebb37cbcb746394" args="(AVPacket *packet)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="player__audio_8c.html#abc8ec9c5260ec70ecebb37cbcb746394">init_packet</a> </td>
          <td>(</td>
          <td class="paramtype">AVPacket *&#160;</td>
          <td class="paramname"><em>packet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize one data packet for reading or writing. </p>
<p>Set the packet data and size so that it is recognized as being empty. </p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00049">49</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_abc8ec9c5260ec70ecebb37cbcb746394_icgraph.png" border="0" usemap="#player__audio_8c_abc8ec9c5260ec70ecebb37cbcb746394_icgraph" alt=""/></div>
<map name="player__audio_8c_abc8ec9c5260ec70ecebb37cbcb746394_icgraph" id="player__audio_8c_abc8ec9c5260ec70ecebb37cbcb746394_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#aac28838d760bc5bd9fa65cadd10d73cf" title="decode_audio_frame" alt="" coords="140,5,281,35"/><area shape="rect" id="node5" href="player__audio_8c.html#a5357f230b8fd19ed3c04233e49316c8b" title="encode_audio_frame" alt="" coords="140,59,281,88"/><area shape="rect" id="node7" href="player__audio_8c.html#a1fd0150c4090f6a008d8a8fafcff62d8" title="load_encode_and_write" alt="" coords="332,59,489,88"/><area shape="rect" id="node9" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb" title="audiolive_decode_encode" alt="" coords="539,59,709,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7ee8b4fa5255ba1e25decc9d96b5a983"></a><!-- doxytag: member="player_audio.c::init_resampler" ref="a7ee8b4fa5255ba1e25decc9d96b5a983" args="(AVCodecContext *input_codec_context, AVCodecContext *output_codec_context, SwrContext **resample_context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="player__audio_8c.html#a7ee8b4fa5255ba1e25decc9d96b5a983">init_resampler</a> </td>
          <td>(</td>
          <td class="paramtype">AVCodecContext *&#160;</td>
          <td class="paramname"><em>input_codec_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AVCodecContext *&#160;</td>
          <td class="paramname"><em>output_codec_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SwrContext **&#160;</td>
          <td class="paramname"><em>resample_context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize the audio resampler based on the input and output codec settings. If the input and output sample formats differ, a conversion is required libswresample takes care of this, but requires initialization. </p>
<p>Create a resampler context for the conversion. Set the conversion parameters. Default channel layouts based on the number of channels are assumed for simplicity (they are sometimes not detected properly by the demuxer and/or decoder).</p>
<p>Perform a sanity check so that the number of converted samples is not greater than the number of samples to be converted. If the sample rates differ, this case has to be handled differently</p>
<p>Open the resampler with the specified parameters. </p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00073">73</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_a7ee8b4fa5255ba1e25decc9d96b5a983_icgraph.png" border="0" usemap="#player__audio_8c_a7ee8b4fa5255ba1e25decc9d96b5a983_icgraph" alt=""/></div>
<map name="player__audio_8c_a7ee8b4fa5255ba1e25decc9d96b5a983_icgraph" id="player__audio_8c_a7ee8b4fa5255ba1e25decc9d96b5a983_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb" title="audiolive_decode_encode" alt="" coords="157,5,328,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1fd0150c4090f6a008d8a8fafcff62d8"></a><!-- doxytag: member="player_audio.c::load_encode_and_write" ref="a1fd0150c4090f6a008d8a8fafcff62d8" args="(AVAudioFifo *fifo, AVFormatContext *output_format_context, AVCodecContext *output_codec_context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="player__audio_8c.html#a1fd0150c4090f6a008d8a8fafcff62d8">load_encode_and_write</a> </td>
          <td>(</td>
          <td class="paramtype">AVAudioFifo *&#160;</td>
          <td class="paramname"><em>fifo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AVFormatContext *&#160;</td>
          <td class="paramname"><em>output_format_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AVCodecContext *&#160;</td>
          <td class="paramname"><em>output_codec_context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Load one audio frame from the FIFO buffer, encode and write it to the output file. </p>
<p>Temporary storage of the output samples of the frame written to the file.</p>
<p>Use the maximum number of possible samples per frame. If there is less than the maximum possible frame size in the FIFO buffer use this number. Otherwise, use the maximum possible frame size</p>
<p>Initialize temporary storage for one output frame.</p>
<p>Read as many samples from the FIFO buffer as required to fill the frame. The samples are stored in the frame temporarily.</p>
<p>Encode one frame worth of audio samples. </p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00346">346</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_a1fd0150c4090f6a008d8a8fafcff62d8_cgraph.png" border="0" usemap="#player__audio_8c_a1fd0150c4090f6a008d8a8fafcff62d8_cgraph" alt=""/></div>
<map name="player__audio_8c_a1fd0150c4090f6a008d8a8fafcff62d8_cgraph" id="player__audio_8c_a1fd0150c4090f6a008d8a8fafcff62d8_cgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#ae0deb6480c1c387f2035f2ddb91f8b14" title="init_output_frame" alt="" coords="224,5,347,35"/><area shape="rect" id="node7" href="player__audio_8c.html#a5357f230b8fd19ed3c04233e49316c8b" title="encode_audio_frame" alt="" coords="215,59,356,88"/><area shape="rect" id="node5" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa" title="get_error_text" alt="" coords="407,5,508,35"/><area shape="rect" id="node9" href="player__audio_8c.html#abc8ec9c5260ec70ecebb37cbcb746394" title="init_packet" alt="" coords="415,59,500,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_a1fd0150c4090f6a008d8a8fafcff62d8_icgraph.png" border="0" usemap="#player__audio_8c_a1fd0150c4090f6a008d8a8fafcff62d8_icgraph" alt=""/></div>
<map name="player__audio_8c_a1fd0150c4090f6a008d8a8fafcff62d8_icgraph" id="player__audio_8c_a1fd0150c4090f6a008d8a8fafcff62d8_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#a4f9b8b73acff764504b43cbb04cdbaeb" title="audiolive_decode_encode" alt="" coords="213,5,384,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae66f6b31b5ad750f1fe042a706a4e3d4"></a><!-- doxytag: member="player_audio.c::main" ref="ae66f6b31b5ad750f1fe042a706a4e3d4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="test_sensors_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00883">883</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_ae66f6b31b5ad750f1fe042a706a4e3d4_cgraph.png" border="0" usemap="#player__audio_8c_ae66f6b31b5ad750f1fe042a706a4e3d4_cgraph" alt=""/></div>
<map name="player__audio_8c_ae66f6b31b5ad750f1fe042a706a4e3d4_cgraph" id="player__audio_8c_ae66f6b31b5ad750f1fe042a706a4e3d4_cgraph">
<area shape="rect" id="node3" href="config__env_8h.html#a7a3442c830784b7d0aea5290269232ad" title="Get the value of a config variable from the env." alt="" coords="104,5,219,35"/><area shape="rect" id="node5" href="player__audio_8c.html#aee1ca14a933f54d8d70fcd22a2a8ece1" title="aic_audioplayer" alt="" coords="105,59,217,88"/><area shape="rect" id="node7" href="socket_8h.html#a548f0ed12e49a65bf1a6b62c0d30ccab" title="Connect to a host:port couple." alt="" coords="297,32,393,61"/><area shape="rect" id="node9" href="player__audio_8c.html#af16360dc3fbd73cf6d2ee8415449bc63" title="write_output_file_trailer" alt="" coords="268,85,423,115"/><area shape="rect" id="node11" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa" title="get_error_text" alt="" coords="473,85,575,115"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af16360dc3fbd73cf6d2ee8415449bc63"></a><!-- doxytag: member="player_audio.c::write_output_file_trailer" ref="af16360dc3fbd73cf6d2ee8415449bc63" args="(AVFormatContext *output_format_context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="player__audio_8c.html#af16360dc3fbd73cf6d2ee8415449bc63">write_output_file_trailer</a> </td>
          <td>(</td>
          <td class="paramtype">AVFormatContext *&#160;</td>
          <td class="paramname"><em>output_format_context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Write the trailer of the output file container. </p>

<p>Definition at line <a class="el" href="player__audio_8c_source.html#l00386">386</a> of file <a class="el" href="player__audio_8c_source.html">player_audio.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_af16360dc3fbd73cf6d2ee8415449bc63_cgraph.png" border="0" usemap="#player__audio_8c_af16360dc3fbd73cf6d2ee8415449bc63_cgraph" alt=""/></div>
<map name="player__audio_8c_af16360dc3fbd73cf6d2ee8415449bc63_cgraph" id="player__audio_8c_af16360dc3fbd73cf6d2ee8415449bc63_cgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#aa51efe8890c8ebdfedfacbf61a13f7aa" title="get_error_text" alt="" coords="212,5,313,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="player__audio_8c_af16360dc3fbd73cf6d2ee8415449bc63_icgraph.png" border="0" usemap="#player__audio_8c_af16360dc3fbd73cf6d2ee8415449bc63_icgraph" alt=""/></div>
<map name="player__audio_8c_af16360dc3fbd73cf6d2ee8415449bc63_icgraph" id="player__audio_8c_af16360dc3fbd73cf6d2ee8415449bc63_icgraph">
<area shape="rect" id="node3" href="player__audio_8c.html#aee1ca14a933f54d8d70fcd22a2a8ece1" title="aic_audioplayer" alt="" coords="211,5,323,35"/><area shape="rect" id="node5" href="player__audio_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="main" alt="" coords="371,5,421,35"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 19 2017 14:10:10 for AiCPlayer by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
